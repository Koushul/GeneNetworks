{"timestamp": 1641683309.375439, "stored_source_code": "def generate_traits(upstream, product):\n\n    clinical_from_broad = pd.read_parquet(str(upstream['download_clinical']['clinical_from_broad']))\n    clinical_from_cbioportal = pd.read_parquet(str(upstream['download_clinical']['clinical_from_cbioportal']))\n\n    clinical_from_cbioportal = clinical_from_cbioportal.drop([0, 1, 2, 3])\n    clinical_from_cbioportal = clinical_from_cbioportal.set_index('#Patient Identifier')\n    traits = clinical_from_cbioportal[['Subtype', 'Overall Survival Status']].copy()\n    traits.index.name = None\n    traits.columns = ['hpv', 'survival']\n    traits = traits.dropna()\n    traits.hpv = traits.hpv.replace({'HNSC_HPV-': 0, 'HNSC_HPV+': 1})\n    traits['survival'] = traits['survival'].replace({'0:LIVING': 1, '1:DECEASED': 0})\n\n    traits = traits.join(clinical_from_broad['patient.tobacco_smoking_history']).dropna()\n    traits.columns = ['hpv', 'survival', 'smoker']\n    traits.smoker = traits.smoker.apply(lambda x: 0 if x in ['1', '3'] else 1)\n\n    traits.to_parquet(str(product))\n", "params": {}}